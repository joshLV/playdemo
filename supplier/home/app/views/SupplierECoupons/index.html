#{extends 'layout_trader/layout2.html' /}
#{set title:'券号列表' /}
#{set menu:"coupons" /}
#{set 'moreStyles'}
    #{asset.css src:['/m/coupons.css'] /}
#{/set}
#{set 'moreScripts'}
<script src="@{'/public/javascripts/My97DatePicker/WdatePicker.js'}" type="text/javascript" charset="UTF-8"></script>
#{/set}
<div class="coupons">
    <h2>${title}</h2>
    <form class="well form-inline" name="frmlist" id="frmlist" action="@{SupplierECoupons.index()}" method="GET">
        <div class="field-group">
            <label>选择分店</label>
        #{select 'condition.shopId', id:shopId, value:condition?.shopId}
            #{option ""}全部#{/option}
            #{list items:shopList, as:'shop'}
                #{option shop?.id}${shop?.name}#{/option}
            #{/list}
        #{/select}
        </div>
        <div class="field-group">
            <label>验证方式</label>
        #{select 'condition.verifyType', id:'condition_verifyType', value:condition?.verifyType}
            #{option ""}不限#{/option}
            #{option "CLERK_MESSAGE"}&{'coupon.CLERK_MESSAGE'}#{/option}
            #{option "CONSUMER_MESSAGE"}&{'coupon.CONSUMER_MESSAGE'}#{/option}
            #{option "SHOP"}&{'coupon.SHOP'}#{/option}
            #{option "TELEPHONE"}&{'coupon.TELEPHONE'}#{/option}
            #{option "OP_VERIFY"}&{'coupon.OP_VERIFY'}#{/option}
        #{/select}
        </div>
        <div class="field-group">
            <label>订单来源</label>
        #{select 'condition.accountType', value:condition.accountType}
            #{option ""}不限#{/option}
            #{option "CONSUMER"}&{'order.CONSUMER'}#{/option}
            #{option "RESALER"}&{'order.RESALER'}#{/option}
        #{/select}
        </div>

        <div class="field-group">
            <label>消费时间</label>
            <span>从</span>
            <input type="text" id="condition_consumed_begin" class="Wdate"
                   name="condition.consumedAtBegin"
                   onfocus="WdatePicker({readOnly:true})" value="${condition.consumedAtBegin?.format()}">
            <span>到</span>
            <input type="text" id="condition_consumed_end" class="Wdate"
                   name="condition.consumedAtEnd"
                   onfocus="WdatePicker({readOnly:true})" value="${condition.consumedAtEnd?.format()}">
        </div>
        <div class="field-group">
            <input type="submit" class="btn" value="查询"/>
        </div>
    </form>

    <table cellspacing="0" cellpadding="0" border="0" class="title-table">
        <tr>
            <th wdith="50%">查询结果合计：10</th>
            <td wdith="50%"><a href="">导出</a></td>
        </tr>
    </table>

*{<div style="margin-bottom: 12px">}*
*{<button class="btn btn-primary" type="button">导出报表</button>}*
*{</div>}*

    <table cellspacing="0" cellpadding="0" border="0" class="standard-table">
        <thead>
        <tr>
            <th width="10px">券号</th>
            <th width="120px">商品名称</th>
            <th width="30px">单价</th>
            <th width="50px">消费门店</th>
            <th width="40px">验证方式</th>
            <th width="50px">消费时间</th>
            <th width="50px">店员</th>
        </tr>
        </thead>

        <tbody>
        #{set i:0/}
        #{paginate.list items:couponPage, as:'coupon'}
        <tr>
            <td>${coupon?.eCouponSn}</td>
            <td>${coupon?.goods?.shortName}</td>
            <td>${coupon?.salePrice?.formatCurrency('CNY')}</td>
            <td>${coupon?.getConsumedShop()}</td>
            <td>&{'coupon.'+coupon?.verifyType}</td>
            <td>${coupon?.consumedAt?.format("yyyy-MM-dd HH:mm:ss")}</td>
            <td>#{if coupon?.supplierUser?.userName!=null}${coupon?.supplierUser?.userName}#{/if}
                #{if coupon?.supplierUser?.jobNumber!=null}(工号: ${coupon?.supplierUser?.jobNumber})#{/if}</td>
        </tr>
        #{/paginate.list}

        </tbody>
    </table>
    <div class="pagination" align="center">
        <ul>
        #{paginate.controls items:couponPage /}
        </ul>
    </div>
</div>
<script type="text/javascript">
    function couponIndex() {
        $("#frmlist").attr("action", "@{SupplierECoupons.index()}");
        $("#frmlist").attr("method", "get");
        $("#frmlist").submit();
    }

    function couponExcel() {
        $("#frmlist").attr("action", "@{SupplierECoupons.couponExcelOut()}");
        $("#frmlist").attr("method", "get");
        $("#frmlist").submit();
    }
</script>