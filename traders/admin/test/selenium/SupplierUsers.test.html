#{fixture delete:[models.admin.SupplierUser.class,models.admin.SupplierRole.class,models.supplier.Supplier.class],load:['fixture/roles.yml','fixture/supplier_users.yml'] /}

#{selenium}
   #{include 'test/selenium/step/login.selenium' /}
   open('/users')
   assertTitle('操作员一览')
#{/selenium}

#{selenium}
   #{include 'test/selenium/step/login.selenium' /}
   open('/users/${play.test.Fixtures.idCache.get("models.admin.SupplierUser-user1")}/edit')
   assertTitle('操作员编辑')
#{/selenium}


#{selenium}
   #{include 'test/selenium/step/login.selenium' /}
   open('/users/${play.test.Fixtures.idCache.get("models.admin.SupplierUser-user3")}/edit')
   click('xpath=(//input[@id='supplierUser.roles.id'])[2]')
   type('id=loginName','yan1')
   type('id=mobile','13012012011')
   type('name=supplierUser.encryptedPassword','')
   clickAndWait('id=save')
   verifyTextPresent('请输入密码!')
#{/selenium}

#{selenium "edit user"}
   #{include 'test/selenium/step/login.selenium' /}
   open('/users/${play.test.Fixtures.idCache.get("models.admin.SupplierUser-test")}/edit')
   click('id=supplierUser.roles_${play.test.Fixtures.idCache.get("models.admin.SupplierRole-sales")}')
   type('id=loginName','test1')
   type('id=mobile','13088092013')
   type('name=supplierUser.encryptedPassword','123')
   clickAndWait('id=save')
   open('/users')
   assertTitle('操作员一览')
   verifyText('//tr[3]/td','test1')
   verifyText('//tr[3]/td[2]','[销售人员]')
   verifyText('//tr[3]/td[3]','2012-03-12 00:00:00')
#{/selenium}

#{selenium "delete user"}
  #{include 'test/selenium/step/login.selenium' /}
  open('/users')
  assertTitle('操作员一览')
  verifyTextPresent('test_delete_user')
  clickAndWait('id=del_${play.test.Fixtures.idCache.get("models.admin.SupplierUser-deleteuser")}')
  assertConfirmation('确定删除吗？')
  
  verifyTextPresent('操作员一览')
  verifyTextNotPresent('test_delete_user')
#{/selenium}


