#{fixture delete:[models.admin.SupplierUser.class,models.admin.SupplierRole.class,models.supplier.Supplier.class],load:['fixture/roles.yml','fixture/supplier_users.yml'] /}

#{selenium}
   #{include 'test/selenium/step/login.selenium' /}
   open('/users')
   assertTitle('操作员一览')
   verifyTextNotPresent('admin')
#{/selenium}

#{selenium "edit"}
   #{include 'test/selenium/step/login.selenium' /}
   open('/users/${play.test.Fixtures.idCache.get("models.admin.SupplierUser-user1")}/edit')
   assertTitle('操作员编辑')
#{/selenium}


#{selenium "edit user"}
   #{include 'test/selenium/step/login.selenium' /}
   open('/users')
   assertTitle('操作员一览')
   verifyText('//tr[3]/td','test')
   verifyText('//tr[3]/td[5]','[测试角色]')

   open('/users/${play.test.Fixtures.idCache.get("models.admin.SupplierUser-test")}/edit')
   click('id=supplierUser.roles_${play.test.Fixtures.idCache.get("models.admin.SupplierRole-sales")}')
   verifyTextPresent('test')
   type('id=mobile','13088092013')
   *{type('name=supplierUser.encryptedPassword','123')}*
   clickAndWait('id=save')
   open('/users')
   assertTitle('操作员一览')
   verifyText('//tr[3]/td','test')
   verifyText('//tr[3]/td[5]','[销售经理, 测试角色]')
   verifyText('//tr[3]/td[6]','2012-03-12 00:00:00')
#{/selenium}

#{selenium "delete user"}
  #{include 'test/selenium/step/login.selenium' /}
  open('/users')
  assertTitle('操作员一览')
  verifyTextPresent('test_delete_user')
  clickAndWait('id=del_${play.test.Fixtures.idCache.get("models.admin.SupplierUser-deleteuser")}')
  assertConfirmation('确定删除吗？')

  verifyTextPresent('操作员一览')
  verifyTextNotPresent('test_delete_user')
#{/selenium}


 #{selenium "edit 个人信息"}
   #{include 'test/selenium/step/login.selenium' /}
   open('/profile')
   assertTitle('个人信息')
   verifyTextPresent('yan')
   assertValue('id=mobile','13211111111')
   assertValue('id=jobNumber','1003')
   type('id=mobile','13211111121')
   type('id=jobNumber','1009')
   clickAndWait('id=save')
   assertValue('id=mobile','13211111121')
   assertValue('id=jobNumber','1009')

#{/selenium}

