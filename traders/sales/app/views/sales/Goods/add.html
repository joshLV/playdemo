#{extends 'layout_trader/layout.html' /}
#{set title:'添加电子消费券' /}
#{get 'moreScripts'}
<script src="@{'/public/javascripts/kindeditor.js'}" type="text/javascript" charset="UTF-8"></script>
<script src="@{'/public/javascripts/My97DatePicker/WdatePicker.js'}" type="text/javascript" charset="UTF-8"></script>
#{/get}
#{include 'sales/Goods/nav.html' /}
<div class="body">
    <form class="form-horizontal" name="frm" action="@{Goods.create()}" method="post" enctype="multipart/form-data">
        <legend>添加电子消费券</legend>
        <div class="control-group">
            <label for="select01" class="control-label"><font color="red">*</font>商品类型</label>

            <div class="controls">
                <select id="materialtype" name="goods.materialType" class="input-small">
                    <option value="ELECTRONIC">&{'goods.ELECTRONIC'}</option>
                    <option value="REAL">&{'goods.REAL'}</option>
                </select>
                <select id="select03" class="input-small">
                    <option value="">请选择</option>
                </select>
                <select id="select03" class="input-small">
                    <option value="">请选择</option>
                </select>
                <span class="error">#{error 'goods.name' /}</span>
            </div>
        </div>
        <div class="control-group">
            <label for="select01" class="control-label"><font color="red">*</font>品&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;牌</label>

            <div class="controls">
                <select id="select03" name="goods.brand.id" class="input-small">
                #{list items:brandList, as:'brand' }
                    <option value="${brand.id}">${brand.name}</option>
                #{/list}
                </select>
            </div>
        </div>
        <div class="control-group">
            <label for="input01" class="control-label">商品编号</label>

            <div class="controls">
                <input type="text" id="no" name="goods.no" class="input-xlarge"/>
            </div>
        </div>
        <div class="control-group">
            <label for="input01" class="control-label"><font color="red">*</font>商品名称</label>

            <div class="controls">
                <input type="text" id="goods_name" name="goods.name" class="input-xlarge"/>
                <span class="error">#{error 'goods.name' /}</span>
            </div>
        </div>
        <div class="control-group">
            <label for="input01" class="control-label"><font color="red">*</font>券有效期</label>

            <div class="controls">
                <input class="input-medium Wdate" type="text" id="effectiveAt" name="goods.effectiveAt"
                       onfocus="WdatePicker({readOnly:true})"/>至 <input class="input-medium Wdate" type="text"
                                                                        id="expireAt"
                                                                        name="goods.expireAt"
                                                                        onfocus="WdatePicker({readOnly:true})"/>
                <span class="error">#{error 'goods.expiredBeginOn' /}</span>
            </div>
        </div>
        <div class="control-group">
            <label for="input01" class="control-label"><font color="red">*</font>原&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;价</label>

            <div class="controls">
                <input type="text" id="originalPrice" name="goods.originalPrice" class="input-small"/>
                <span class="error">#{error 'goods.originalPrice' /}</span>
            </div>
        </div>
        <div class="control-group">
            <label for="input01" class="control-label"><font color="red">*</font>现&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;价</label>

            <div class="controls">
                <input type="text" id="salePrice" name="goods.salePrice" class="input-small"/>
                <span class="error">#{error 'goods.salePrice' /}</span>
            </div>
        </div>
        <div class="control-group">
            <label for="input01" class="control-label"><font color="red">*</font>库&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;存</label>

            <div class="controls">
                <input type="text" id="baseSale" name="goods.baseSale" class="input-small"/>
                <span class="error">#{error 'goods.baseSale' /}</span>
            </div>
        </div>
        <div class="control-group">
            <label for="input01" class="control-label"><font color="red">*</font>商品图片</label>

            <div class="controls">
                <input type="file" id="imagePath" name="imagePath" class="input-file"/>
            </div>
            <div class="controls">
                <span class="error">#{error 'goods.imagePath'/}</span></div>
        </div>
        <div class="control-group">
            <label for="textarea" class="control-label">温馨提示</label>

            <div class="controls">
                <textarea name="goods.prompt" id="prompt" cols="100" rows="8"
                          style="width:700px;height:200px;visibility:hidden;"></textarea>
            </div>
        </div>
        <div class="control-group">
            <label for="textarea" class="control-label"><font color="red">*</font>商品详情</label>

            <div class="controls">
                <textarea name="goods.details" id="details" cols="100" rows="8"
                          style="width:700px;height:200px;visibility:hidden;"></textarea>
                <span class="error">#{error 'goods.details' /}</span>
            </div>
        </div>
        <div class="control-group">
            <label for="textarea" class="control-label">使用门店</label>

            <div class="controls">
                <input type="radio" checked value="1" id="radios1" name="radios"/>全部门店
                <input type="radio" value="2" id="radios2" name="radios"/>部分门店
            </div>
            <div class="controls" id="shop" style="display:none">
                <table class="table table-striped table-bordered table-condensed">
                    <tbody>
                    #{list items:shopListt, as:'row' }
                    <tr>
                        <td><input type="checkbox" id="checkoption" value="${row.id}" name="checkoption[]"/></td>
                        <td>${row.name}</td>
                        <td>${row.address}</td>
                        <td>${row.phone}</td>
                    </tr>
                    #{/list}
                    </tbody>
                </table>
            </div>

        </div>
        <div class="form-actions">
            <button class="btn btn-primary" id="save" type="submit">保存</button>
            <button class="btn btn-primary" id="onsales" type="submit">保存并上架</button>
            <input type="hidden" id="status" name="status" value="0"/>
            <button class="btn btn-primary" id="view" type="submit">保存预览</button>
        </div>
    </form>

#{get 'moreScripts'}
    <script type="text/javascript">

        KE.show({
            id:'prompt',
            imageUploadJson:'@{UploadFile.uploadJson()}',
            fileManagerJson:'@{UploadFile.fileManagerJson()}',
            allowFileManager:true,
            afterCreate:function (id) {
                KE.event.ctrl(document, 13, function () {
                    KE.util.setData(id);
                    document.forms['frm'].submit();
                });
                KE.event.ctrl(KE.g[id].iframeDoc, 13, function () {
                    KE.util.setData(id);
                    document.forms['frm'].submit();
                });
            }
        });

        KE.show({
            id:'details',
            imageUploadJson:'@{UploadFile.uploadJson()}',
            fileManagerJson:'@{UploadFile.fileManagerJson()}',
            allowFileManager:true,
            afterCreate:function (id) {
                KE.event.ctrl(document, 13, function () {
                    KE.util.setData(id);
                    document.forms['frm'].submit();
                });
                KE.event.ctrl(KE.g[id].iframeDoc, 13, function () {
                    KE.util.setData(id);
                    document.forms['frm'].submit();
                });
            }
        });
        $("#onsales").click(function () {
            $("#status").val("1");
        });
        $("#radios2").click(function () {
            $("#shop").show();//显示
        });
        $("#radios1").click(function () {
            $("#shop").hide();//隐藏
        });
        $("#view").click(function () {
            $("#status").val("2");
        });
        $("#save").click(function () {
            $("#status").val("0");
        });
    </script>
#{/get}
</div>


