#{fixture delete:[models.admin.SupplierUser.class,models.admin.SupplierRole.class,
    models.supplier.Supplier.class,
    models.sales.Category.class,
    models.sales.Area.class,
    models.sales.Shop.class,
    models.supplier.Supplier.class,
    models.sales.Goods.class,
    models.sales.Brand.class],
    load:['fixture/roles.yml','fixture/supplierusers.yml','fixture/areas.yml','fixture/base_data.yml','fixture/goods.yml'] /}
%{
    Long supplierId = play.test.Fixtures.idCache.get("models.supplier.Supplier-kfc");
    models.sales.Shop shop = new models.sales.Shop();
    shop.address = "test-shop";
    shop.name = "test-name";
    shop.supplierId = supplierId;
    shop.deleted = com.uhuila.common.constants.DeletedStatus.UN_DELETED;
    shop.create();
}%
#{selenium '添加商品数据-保存按钮'}
    #{include 'test/selenium/step/login.selenium' /}
open('/goods/new')
verifyTitle('添加商品')
verifyTextPresent('添加商品')
select('id=goods_topCategoryId','label=旅游')
*{waitForCondition('selenium.isTextPresent("上海")',10000)}*
*{select('id=categoryId','label=上海')}*
select('id=goods_brand_id','label=豆捞坊')
type('id=goods_no','34')
type('id=goods_name','wwww')
type('id=goods_effectiveAt','2012-03-19')
type('id=goods_expireAt','2015-03-19')
type('id=goods_useBeginTime','09:00')
type('id=goods_useEndTime','')
type('id=goods_originalPrice','55')
type('id=goods_baseSale','55')
*{focus('id=imagePath')}*
*{click('id=imagePath')}*
*{type('id=imagePath','/home/sujie/seewi/reeb-trunk/traders/sales/test/fixture/origin.jpg')}*

runScript('var element= window.document.getElementsByTagName("iframe")[1];')
runScript('idocument = element.contentDocument;')
runScript('element=idocument.getElementsByTagName("body")[0];')
runScript('element.innerHTML  = "this is a test thread";')

clickAndWait('id=save')
verifyTextPresent('请把可用时段输入完整!')

type('id=goods_useBeginTime','19:00')
type('id=goods_useEndTime','09:00')
clickAndWait('id=save')
verifyTextPresent('使用结束时间要大于开始时间!')

*{verifyTitle('电子消费券一览')}*
*{verifyTextPresent('电子消费券一览')}*
#{/selenium}

#{selenium '添加商品数据-保存按钮'}
    #{include 'test/selenium/step/login.selenium' /}
open('/goods/new')
verifyTitle('添加商品')
verifyTextPresent('添加商品')
select('id=goods_topCategoryId','label=旅游')
*{waitForCondition('selenium.isTextPresent("上海")',10000)}*
*{select('id=categoryId','label=上海')}*
select('id=goods_brand_id','label=豆捞坊')
type('id=goods_no','34')
type('id=goods_name','wwww')
type('id=goods_effectiveAt','2012-03-19')
type('id=goods_expireAt','2015-03-19')
type('id=goods_useBeginTime','09:00')
type('id=goods_useEndTime','20:00')
type('id=goods_originalPrice','55')
type('id=goods_baseSale','55')
*{focus('id=imagePath')}*
*{click('id=imagePath')}*
*{type('id=imagePath','/home/sujie/seewi/reeb-trunk/traders/sales/test/fixture/origin.jpg')}*

runScript('var element= window.document.getElementsByTagName("iframe")[1];')
runScript('idocument = element.contentDocument;')
runScript('element=idocument.getElementsByTagName("body")[0];')
runScript('element.innerHTML  = "this is a test thread";')

clickAndWait('id=save')
*{verifyTitle('电子消费券一览')}*
*{verifyTextPresent('电子消费券一览')}*
#{/selenium}

#{selenium '添加商品数据-保存并上架按钮'}
    #{include 'test/selenium/step/login.selenium' /}
open('/goods/new')
verifyTitle('添加商品')
verifyTextPresent('添加商品')
select('id=goods_topCategoryId','label=旅游')
*{waitForCondition('selenium.isTextPresent("上海")',10000)}*
*{select('id=categoryId','label=上海')}*
select('id=goods_brand_id','label=豆捞坊')
type('id=goods_no','34')
type('id=goods_name','wwww')
type('id=goods_effectiveAt','2012-03-19')
type('id=goods_expireAt','2015-03-19')
type('id=goods_originalPrice','55')
type('id=goods_baseSale','55')
*{focus('id=imagePath')}*
*{click('id=imagePath')}*
*{type('id=imagePath','/home/sujie/seewi/reeb-trunk/traders/sales/test/fixture/origin.jpg')}*

runScript('var element= window.document.getElementsByTagName("iframe")[1];')
runScript('idocument = element.contentDocument;')
runScript('element=idocument.getElementsByTagName("body")[0];')
runScript('element.innerHTML  = "this is a test thread";')

clickAndWait('id=onsale')
verifyTitle('添加商品')
verifyTextPresent('无效的图片!')
*{verifyTitle('电子消费券一览')}*
*{verifyTextPresent('电子消费券一览')}*
#{/selenium}

#{selenium '添加商品数据-保存预览按钮'}
    #{include 'test/selenium/step/login.selenium' /}
open('/goods/new')
verifyTitle('添加商品')
verifyTextPresent('添加商品')
select('id=goods_topCategoryId','label=旅游')
*{waitForCondition('selenium.isTextPresent("上海")',10000)}*
*{select('id=categoryId','label=上海')}*
select('id=goods_brand_id','label=豆捞坊')
type('id=goods_no','34')
type('id=goods_name','wwww')
type('id=goods_effectiveAt','2012-03-19')
type('id=goods_expireAt','2015-03-19')
type('id=goods_faceValue','55')
type('id=goods_originalPrice','555')
type('id=goods_baseSale','55')
*{focus('id=imagePath')}*
*{click('id=imagePath')}*
*{type('id=imagePath','/home/sujie/seewi/reeb-trunk/traders/sales/test/fixture/origin.jpg')}*

runScript('var element= window.document.getElementsByTagName("iframe")[1];')
runScript('idocument = element.contentDocument;')
runScript('element=idocument.getElementsByTagName("body")[0];')
runScript('element.innerHTML  = "this is a test thread";')
clickAndWait('id=save')
verifyTitle('添加商品')
verifyTextPresent('无效的图片!')
verifyTextPresent('采购价不能超过原价!')
#{/selenium}



