#{fixture delete:[models.consumer.User.class,models.order.Order.class,models.sales.Category.class,models.sales.Area.class,
models.sales.Shop.class, models.sales.Goods.class,models.order.OrderItems.class,models.order.ECoupon.class] ,
load:['fixture/user.yml','fixture/goods_base.yml','fixture/goods.yml','fixture/orders.yml','fixture/orderItems.yml'] /}

%{
     userId = play.test.Fixtures.idCache.get("models.consumer.User-selenium");
     user = models.consumer.User.findById(userId);
     
        orderId = play.test.Fixtures.idCache.get("models.order.Order-order1");
        order1 = models.order.Order.findById(orderId);
        order1.setUser(user.getId(), models.accounts.AccountType.CONSUMER);

        orderId =  play.test.Fixtures.idCache.get("models.order.Order-order2");
        order2 = models.order.Order.findById(orderId);
        order2.setUser(user.getId(), models.accounts.AccountType.CONSUMER);
        
        id=play.test.Fixtures.idCache.get("models.order.ECoupon-coupon3");
}%



#{selenium "查看我购买的商品"}
    #{include 'test/selenium/step/login.selenium' /}
    openAndWait('/orders')
    assertTitle('一百券 - 我的订单')
    openAndWait('/coupons')
    assertTitle('一百券 - 我的券')
#{/selenium}

#{selenium '查看订单详细信息'}
    open('/orders/${order1.orderNumber}')
    assertTitle('一百券 - 商品详情')
    verifyTextPresent('订单详情')
#{/selenium}

#{selenium '申请退款'}
    open('/orders/refund/${order1.orderNumber}')
    assertTitle('申请退款')
    verifyTextPresent('未消费')
#{/selenium}

