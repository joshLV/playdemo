#{fixture delete:[models.consumer.User.class,models.order.Order.class,models.sales.Category.class,models.sales.Area.class,
models.sales.Shop.class, models.sales.Goods.class,models.order.OrderItems.class,models.order.ECoupon.class] ,
load:['fixture/user.yml','fixture/goods_base.yml','fixture/goods.yml','fixture/orders.yml','fixture/orderItems.yml'] /}

%{
     userId = play.test.Fixtures.idCache.get("models.consumer.User-selenium");
     user = models.consumer.User.findById(userId);
     
        orderId = play.test.Fixtures.idCache.get("models.order.Order-order1");
        order = models.order.Order.findById(orderId);
        order.setUser(user.getId(), models.accounts.AccountType.CONSUMER);

        orderId =  play.test.Fixtures.idCache.get("models.order.Order-order2");
        order = models.order.Order.findById(orderId);
        order.setUser(user.getId(), models.accounts.AccountType.CONSUMER);
}%



#{selenium "查看我购买的商品"}
    #{include 'test/selenium/step/login.selenium' /}
    openAndWait('/orders')
    assertTitle('优惠啦 - 我购买的商品')
    verifyTextPresent('您的位置：首页 > 我的订单')
    openAndWait('/coupons')
    assertTitle('优惠啦 - 券订单')
    verifyTextPresent('您的位置：首页 > 我的券订单')
#{/selenium}

#{selenium '查看订单详细信息'}
    open('/orders/${play.test.Fixtures.idCache.get("models.order.Order-order1")}')
    assertTitle('优惠啦 - 商品详情')
    verifyTextPresent('您的位置：首页>我的优惠啦>我购买的商品>商品详情')
#{/selenium}

