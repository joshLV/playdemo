#{extends 'main.html' /}
#{set title:'一百券 - 我的积分-兑换记录' /}
#{set 'moreStyles'}
    #{asset.css src:['/y/user/userBase.css','y/user/userExchange.css'] /}

#{/set}

#{set 'moreScripts'}
<script src="@{'/public/javascripts/My97DatePicker/WdatePicker.js'}" type="text/javascript" charset="UTF-8"></script>
<script>
    $(function () {
        $("#pointNumber").change(function () {
            $('#couponsFrm').submit();
        });

        $("#condition_status").change(function () {
            $('#couponsFrm').submit();
        });

    });
</script>

*{<link rel="stylesheet" href="y/user/userBase.css" />}*
*{<link rel="stylesheet" href="y/user/userExchange.css" />}*

#{/set}
<div id="content" class="clearfix">
#{include "share/left.html"/}
    <div class="section">
    #{breadcrumbs/breadcrumb breadcrumbs/}


        <form class="form-horizontal" id="couponsFrm" action="@{UserPoints.record()}" method="GET">
            <div class="search-box">

                <label>申请时间：</label>
                <input class="Wdate" type="text" name="condition.applyAtBegin" id="applyAtBegin"
                       value="${condition?.applyAtBegin?.format()}" onfocus="WdatePicker({readOnly:true})"/>
                -

                <input class="Wdate" type="text" id="applyAtEnd" name="condition.applyAtEnd"
                       value="${condition?.applyAtEnd?.format()}" onfocus="WdatePicker({readOnly:true})"/>

            *{<td>申请时间：<input type="text" id="applyAtBegin" name="condition.applyAtBegin"}*
            *{value="${condition.applyAtBegin?.format()}" onfocus="WdatePicker({readOnly:true})"}*
            *{class="input-medium Wdate"/>至 <input type="text" id="applyAtEnd"}*
            *{name="condition.applyAtEnd"}*
            *{value="${condition.applyAtEnd?.format()}"}*
            *{onfocus="WdatePicker({readOnly:true})"}*
            *{class="input-medium Wdate"/></td>}*



                <button class="search-btn" id="search" type="submit"> 搜　索</button>
            </div>

            <table class="order-tab">
                <thead>
                <tr class="col-name">
                *{<th width="160">操作时间</th>}*
                *{<th width="160">获得积分</th>}*
                *{<th width="160">使用积分</th>}*
                *{<th width="160">当前积分</th>}*
                *{<th width="154">操作类型</th>}*

                    <th width="160">订单号</th>
                    <th width="160">申请时间</th>
                    <th width="160">商品名称</th>
                    <th width="160">数量</th>
                    <th width="154">所用积分</th>
                    <th width="100">


                    *{#{select 'condition.status', id:'condition_status',  class:'input-medium', value:condition.status}}*
                    #{select 'condition.status', id:'condition_status', class:'deal-status', value:condition?.status}

                        #{option ""}处理状态#{/option}
                        #{option "APPLY"}待发货#{/option}
                        #{option "CANCELED"}审核未通过#{/option}
                        #{option "SENT"}已发货 #{/option}
                        #{option "UNSENT"}未发货 #{/option}
                    #{/select}
                    </th>



                *{<td>订单状态：}*
                *{#{select 'condition.status', id:'condition_status', class:'input-medium', value:condition.status}}*
                *{#{option ""}不限#{/option}}*
                *{#{option "APPLY"}&{'pointGoodsOrder.APPLY'}#{/option}}*
                *{#{option "ACCEPT"}&{'pointGoodsOrder.ACCEPT'}#{/option}}*
                *{#{option "CANCELED"}&{'pointGoodsOrder.CANCELED'}#{/option}}*
                *{#{/select}}*


                </tr>
                </thead>
            #{paginate.list items:pointList, as:'point'}
                <tbody>
                <tr class="sep-row">
                    <td colspan="5"></td>
                </tr>
                <tr class="order-bd">
                *{<td>${point?.createdAt?.format()}</td>}*
                *{<td class="get-integral">${point?.dealType=='1' ? point?.dealPoints:''}</td>}*
                *{<td class="use-integral">${point?.dealType=='0'? point?.dealPoints:''}</td>}*
                *{<td class="current-integral">${point?.currentPoints}</td>}*
                *{<td> ${point?.getPointTitle()}</td>}*

                    <td>${point?.orderNumber}</td>
                    <td>${point?.applyAt?.format("yyyy-MM-dd HH:mm:ss")}</td>

                    <td class="goods-name" >${point?.pointGoodsName}</td>
                    <td>${point?.buyNumber}</td>
                    <td class="use-integral">${point?.amount}</td>





                    #{if models.order.PointGoodsOrderStatus.CANCELED.equals(point?.status)}
                        <td class="inprogress">审核未通过</td>
                    #{/if}

                    #{if models.order.PointGoodsOrderStatus.APPLY.equals(point?.status)}
                        <td class="todo">待处理</td>
                    #{/if}



                    #{if  models.order.PointGoodsOrderSentStatus.SENT.equals(point?.sentStatus)}
                        <td class="done">已发货</td>
                    #{/if}

                    #{if  models.order.PointGoodsOrderStatus.ACCEPT.equals(point?.status)}
                        <td class="done">未发货</td>
                    #{/if}





                *{#{elseif  models.order.PointGoodsOrderSentStatus.SENT.equals(pointGoodsOrder?.sentStatus)}}*
                *{已发货}*
                *{#{/elseif}}*

                *{#{elseif  models.order.PointGoodsOrderStatus.ACCEPT.equals(pointGoodsOrder?.status)}}*
                *{&{'pointGoodsOrder.'+ pointGoodsOrder?.status}}*
                *{<br/>}*
                *{未发货}*

                *{#{/elseif}}*

                *{#{else}}*

                *{&{'pointGoodsOrder.'+ point?.status}}*

                *{#{/else}}*

                *{<td class="inprogress">处理中</td>}*
                *{<td class="done">已发货</td>}*


                </tr>
                </tbody>
            #{/paginate.list}
            </table>
            <div class="pagination">
                <ul>#{paginate.controls items:pointList /}</ul>
            </div>
        </form>
    </div>

    <!-- .section -->
</div>

*{
<div class="wrap clearfix">
    #{include "share/left.html"/}
    <div class="section">
        #{breadcrumbs/breadcrumb breadcrumbs/}
        <div class="tab_top2">账号：${user?.loginName} &nbsp;&nbsp;&nbsp;&nbsp;  积分：${user?.userInfo?.totalPoints}</div>
        <div class="tab_top2">
            <form class="form-horizontal" id="couponsFrm" action="@{UserPoints.index()}" method="GET">
                 <table width="774" border="0" cellpadding="0" cellspacing="0">
                    <tr>
                        <td width="65" align="right">操作时间：</td>
                        <td width="240" height="35"><input class="short_input Wdate" type="text"
                            name="condition.createdAtBegin" id="createdAtBegin" value="${createdAtBegin?.format()}"
                            onfocus="WdatePicker({readOnly:true})" /> - <input class="short_input Wdate" type="text"
                            id="createdAtEnd" name="condition.createdAtEnd" value="${createdAtEnd?.format()}"
                            onfocus="WdatePicker({readOnly:true})" /></td>
                        <td width="65">操作类型：</td>
                        <td width="160">
                            <div class="pos_abs">#{select 'condition.pointNumber', id:'pointNumber',
                                class:'dingdan_stauts_bg', value:pointNumber} 
                                #{option ''}不限#{/option}
                                #{list items:configList, as:'config'}
                                    #{option config?.pointNumber}${config?.pointTitle}#{/option}
                                #{/list}
                                #{/select}</div>
                        </td>
                        <td width="230"><button class="search-btn" id="search"> 搜　索 </button></td>
                    </tr>
                </table>
            </form>
            <table class="order-tab" cellpadding="0" cellspacing="0">
                <thead>
                    <tr class="col-name">              
                        <th width="200">操作时间</th>
                        <th width="150">获得积分 </th>
                        <th width="150">使用积分</th>
                        <th width="150">当前积分</th>
                        <th width="120">操作类型</th>
                    </tr>
                </thead>
                #{paginate.list items:pointList, as:'point'}
                <tr class="order-bd">
                    <td>${point?.createdAt?.format()}</td>
                    <td>${point?.dealType=='1' ? point?.dealPoints:''}</td>
                    <td>${point?.dealType=='0'? point?.dealPoints:''}</td>
                    <td>${point?.currentPoints}</td>
                    <td> ${point?.getPointTitle()}</td> 
                </tr>
                #{/paginate.list}
            </table>
            <div class="pagination">
                <ul>#{paginate.controls items:pointList /}
                </ul>
            </div>
        </div>
    </div>
</div>
}*
