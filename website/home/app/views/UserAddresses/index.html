#{extends 'main.html' /}
#{set title:'优惠啦 - 地址管理' /}
#{set 'moreStyles'}
<link href="@{'/public/stylesheets/default.css'}" rel="stylesheet" type="text/css"/>
<link href="@{'/public/stylesheets/my_good.css'}" rel="stylesheet" type="text/css"/>
<link rel="stylesheet" type="text/css" media="screen" href="@{'/public/stylesheets/play-pagination.css'}">
<link href="@{'/public/stylesheets/user-center.css'}" rel="stylesheet" type="text/css" />
#{/set}

<script type="text/javascript">
    function editAddress(addressId) {
        $("#addressTitle").html("修改地址");
        $("#form").load("/addresses/" + addressId + "/edit", function (data) {
            setAreaValue(addressId);
            $("#form").attr("action", "/addresses/" + addressId + "?x-http-method-override=PUT");
            $("#form").attr("method", "POST");
        });
    }

    function setAreaValue(addressId) {
        $("#china_area").jChinaArea({aspnet:false,
            s1:$("#address_province").attr("selectedValue"),
            s2:$("#address_city").attr("selectedValue"),
            s3:$("#address_district").attr("selectedValue")});
    }
</script>
<!--主体内容部分-->
<div id="wrap clearfix">
    #{include "share/left.html"/}
    <div class="section">
        #{breadcrumbs/breadcrumb breadcrumbs/}
        <div class="tab_top"><span id="addressTitle">新增地址</span></div>
        <div class="tab_top2">
            <form class="form-horizontal" id="form" action="@{UserAddresses.create()}" method="POST">
            #{include "UserAddresses/form.html"/}
            </form>
            <span>已保存地址</span>
            <table class="order-tab">
                <tr class="col-name">
                    <td width="78" height="30" align="center">&{'address.name'}</td>
                    <td width="150" align="center">&{'address.district'}</td>
                    <td width="200" align="center">&{'address.address'}</td>
                    <td width="70" align="center">&{'address.postcode'}</td>
                    <td width="140" align="center">&{'address.phone'}</td>
                    <td width="80"></td>
                    <td width="80" align="center">操作</td>
                </tr>
            #{list items:addressList, as:'address'}
                <tr id="tr_address_${address.id}" height="35px">
                    <td align="left" id="address_name_${address?.id}">&nbsp;${address.name}</td>
                    <td id="address_area_${address?.id}">${address.area}</td>
                    <td id="address_address_${address?.id}">${address.address}</td>
                    <td id="address_postcode_${address?.id}">${address.postcode}</td>
                    <td id="address_phone_${address?.id}">${address.mobile}<br/>${address.normalPhone}</td>
                    <td align="center" id="address_isDefault_${address?.id}">#{if address
                        .isDefault}默认地址#{/if}#{else}#{vx.operateLink url:'/addresses/'+address.id+'/default',
                    text:'设为默认', method:'PUT'/}#{/else}</td>
                    <td width="80" align="center">
                        <a id="update_${address?.id}" class="address_span_modify" href="#" onclick="editAddress(${address?.id})
                                ">修改</a> |
                        #{vx.deleteLink action:"addresses", id:address.id, name:address.name/}
                    </td>
                </tr>
            #{/list}
            </table>
        *{<ul>
                <li class="nav_bg_li">最多保存10个有效地址</li>
            </ul>}*
        </div>

    </div>
</div>
