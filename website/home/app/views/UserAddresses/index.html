#{extends 'main.html' /}
#{set title:'优惠啦 - 地址管理' /}
#{set 'moreStyles'}
<link href="@{'/public/stylesheets/default.css'}" rel="stylesheet" type="text/css"/>
<link href="@{'/public/stylesheets/my_good.css'}" rel="stylesheet" type="text/css"/>
<link rel="stylesheet" type="text/css" media="screen" href="@{'/public/stylesheets/play-pagination.css'}">
#{/set}

<script type="text/javascript">
    function editAddress(addressId) {
        $("#addressTitle").html("修改地址");
        $("#form").load("/addresses/" + addressId + "/edit", function (data) {
            setAreaValue(addressId);
            $("#form").attr("action", "/addresses/" + addressId + "?x-http-method-override=PUT");
            $("#form").attr("method", "POST");
        });
    }

    function setAreaValue(addressId) {
        $("#china_area").jChinaArea({aspnet:false,
            s1:$("#address_province").attr("selectedValue"),
            s2:$("#address_city").attr("selectedValue"),
            s3:$("#address_district").attr("selectedValue")});
    }
</script>
<div id="wrap_main">
    <!--    最顶部导航-->
    <div id="wrap_top">#{include "share/topNavigator.html"/}</div>
    <div id="wrap_top_header">
        <div id="wrap_top_header_left">
            <img src="@{'/public/images/logo.jpg'}"/>
        </div>
        <div id="wrap_top_middle">券生活-惠生活</div>
        <div style="clear: both"></div>
        <div class="nav_hengfu">
            <ul class="nav_bg_ul">
                <li class="nav_bg_li"><a class="current_nav_bg_a" href="#">我的优惠啦</a></li>
                <li class="nav_bg_li"><a class="nav_bg_a nodisplay" href="#">我的优惠啦</a></li>
                <li class="nav_bg_li"><a class="nav_bg_a nodisplay" href="#">我的优惠啦</a></li>
            </ul>
        </div>
    </div>
</div>
<!--主体内容部分-->
<div id="wrap_content">
#{breadcrumbs/breadcrumb breadcrumbs/}
#{include "share/left.html"/}
    <div id="right_content_box">
        <div class="tab_top"><span id="addressTitle">新增地址</span></div>
        <div class="tab_top2">
            <form class="form-horizontal" id="form" action="@{UserAddresses.create()}" method="POST">
            #{include "UserAddresses/form.html"/}
            </form>
        </div>
        <div class="tab_top">已保存地址</div>
        <div class="tab_top2">
            <table width="798" border="0" cellpadding="0" cellspacing="0" bordercolor="#EEEEEE" frame="hsides">
                <tr bgcolor="#F6F6F6">
                    <td width="78" height="30" align="center"><span class="font_strong">&{'address.name'}</span></td>
                    <td width="150" align="center"><span class="font_strong">&{'address.district'}</span></td>
                    <td width="200" align="center"><span class="font_strong">&{'address.address'}</span></td>
                    <td width="70" align="center"><span class="font_strong">&{'address.postcode'}</span>
                    </td>
                    <td width="140" align="center"><span
                            class="font_strong">&{'address.phone'}</span></td>
                    <td width="80"></td>
                    <td width="80" align="center"><span class="font_strong">操作</span></td>
                </tr>
            #{list items:addressList, as:'address'}
                <tr id="tr_address_${address.id}" height="35px">
                    <td align="left" id="address_name_${address?.id}">&nbsp;${address.name}</td>
                    <td id="address_area_${address?.id}">${address.area}</td>
                    <td id="address_address_${address?.id}">${address.address}</td>
                    <td id="address_postcode_${address?.id}">${address.postcode}</td>
                    <td id="address_phone_${address?.id}">${address.mobile}<br/>${address.normalPhone}</td>
                    <td align="center" id="address_isDefault_${address?.id}">#{if address
                        .isDefault}默认地址#{/if}#{else}#{vx.operateLink url:'/addresses/'+address.id+'/default',
                    text:'设为默认', method:'PUT'/}#{/else}</td>
                    <td width="80" align="center">
                        <a id="update_${address?.id}" class="address_span_modify" href="#" onclick="editAddress(${address?.id})
                                ">修改</a> |
                        #{vx.deleteLink action:"addresses", id:address.id, name:address.name/}
                    </td>
                </tr>
            #{/list}
            </table>
            *{<ul>
                <li class="nav_bg_li">最多保存10个有效地址</li>
            </ul>}*
        </div>
    </div>
</div>
