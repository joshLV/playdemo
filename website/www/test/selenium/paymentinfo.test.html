#{fixture delete:[models.order.Order.class,models.sales.Category.class,models.sales.Area.class,
models.sales.Shop.class, models.sales.Goods.class,models.order.OrderItems.class,
models.order.ECoupon.class,
models.consumer.User.class,
models.accounts.Account.class
] ,
load:['fixture/categories_unit.yml','fixture/areas_unit.yml','fixture/brands_unit.yml',
'fixture/user.yml',
'fixture/shops_unit.yml','fixture/goods_unit.yml',
'fixture/accounts.yml', 'fixture/account_uhuila.yml','fixture/payment_source.yml', 'fixture/orders.yml'] /}

%{
id = play.test.Fixtures.idCache.get("models.consumer.User-user");
user = models.consumer.User.findById(id);

id = play.test.Fixtures.idCache.get("models.order.Order-order1");
order = models.order.Order.findById(id);
order.setUser(user, models.accounts.AccountType.CONSUMER);

id = play.test.Fixtures.idCache.get("models.order.Order-order_unpaid");
order = models.order.Order.findById(id);
order.setUser(user, models.accounts.AccountType.CONSUMER);
}%


#{selenium "测试打开支付页"}
    #{include 'test/selenium/step/login.selenium' /}
	open('/payment_info/${play.test.Fixtures.idCache.get("models.order.Order-order_unpaid")}')
    assertTitle('优惠啦 - 确认付款')
    verifyTextNotPresent('对不起，找不到您所需要的订单:(')
    openAndWait('/logout')
#{/selenium}
