#{fixture delete:[
models.admin.SupplierUser.class,models.admin.SupplierRole.class,
models.sales.Category.class,
models.sales.Area.class,
models.supplier.Supplier.class,
models.sales.Goods.class,
models.sales.Brand.class],
load:['fixture/roles.yml','fixture/supplierusers.yml','fixture/areas.yml','fixture/base_data.yml','fixture/goods.yml'] /}
#{selenium '添加商品数据-保存按钮'}
    #{include 'test/selenium/step/login.selenium' /}
open('/goods/new')
verifyTitle('添加商品')
verifyTextPresent('添加商品')
verifyTextPresent('电子券')
verifyTextPresent('实物')
verifyTextPresent('淘宝网')
select('id=goods_supplierId','label=肯德基')
select('id=goods_topCategoryId','label=旅游')
*{waitForCondition('selenium.isTextPresent("上海")',10000)}*
*{select('id=categoryId','label=上海')}*
select('id=goods_brand_id','label=来一份')
type('id=goods_no','34')
type('id=goods_name','wwww')
type('id=goods_effectiveAt','2012-03-19')
type('id=goods_expireAt','2015-03-19')
type('id=goods_useBeginTime','09:00')
type('id=goods_useEndTime','')
type('id=goods_originalPrice','55')
type('id=goods_salePrice','55')
type('id=goods_baseSale','55')
*{focus('id=imagePath')}*
*{click('id=imagePath')}*
*{type('id=imagePath','/home/sujie/seewi/reeb-trunk/traders/sales/test/fixture/origin.jpg')}*

runScript('var element= window.document.getElementsByTagName("iframe")[1];')
runScript('idocument = element.contentDocument;')
runScript('element=idocument.getElementsByTagName("body")[0];')
runScript('element.innerHTML  = "this is a test thread";')

clickAndWait('id=save')

verifyTextPresent('请把使用时间输入完整!')

type('id=goods_useBeginTime','19:00')
type('id=goods_useEndTime','09:00')
clickAndWait('id=save')
verifyTextPresent('使用结束时间要大于开始时间!')

type('id=goods_useBeginTime','09:00')
type('id=goods_useEndTime','19:00')
clickAndWait('id=save')
*{verifyTitle('商品一览')}*
*{verifyTextPresent('商品一览')}*
#{/selenium}

#{selenium '添加商品数据-保存并上架按钮'}
    #{include 'test/selenium/step/login.selenium' /}
open('/goods/new')
verifyTitle('添加商品')
verifyTextPresent('添加商品')
verifyTextPresent('淘宝网')
select('id=goods_supplierId','label=肯德基')
waitForText('id=goods_brand_id','来一份 豆捞坊')

select('id=goods_topCategoryId','label=旅游')
*{waitForCondition('selenium.isTextPresent("上海")',10000)}*
*{select('id=categoryId','label=上海')}*
select('id=goods_brand_id','label=来一份')
type('id=goods_no','34')
type('id=goods_name','wwww')
type('id=goods_effectiveAt','2012-03-19')
type('id=goods_expireAt','2015-03-19')
type('id=goods_originalPrice','55')
type('id=goods_salePrice','55')
type('id=goods_baseSale','55')
*{focus('id=imagePath')}*
*{click('id=imagePath')}*
*{type('id=imagePath','/home/sujie/seewi/reeb-trunk/traders/sales/test/fixture/origin.jpg')}*

runScript('var element= window.document.getElementsByTagName("iframe")[1];')
runScript('idocument = element.contentDocument;')
runScript('element=idocument.getElementsByTagName("body")[0];')
runScript('element.innerHTML  = "this is a test thread";')

clickAndWait('id=onsale')
verifyTitle('添加商品')
verifyTextPresent('无效的图片!')
*{verifyTitle('商品一览')}*
*{verifyTextPresent('商品一览')}*
#{/selenium}

#{selenium '添加商品数据-保存预览按钮'}
    #{include 'test/selenium/step/login.selenium' /}
open('/goods/new')
verifyTitle('添加商品')
verifyTextPresent('添加商品')
verifyTextPresent('淘宝网')
select('id=goods_supplierId','label=肯德基')
select('id=goods_topCategoryId','label=旅游')
select('id=goods_brand_id','label=豆捞坊')
type('id=goods_no','34')
type('id=goods_name','wwww')
type('id=goods_effectiveAt','2015-03-19')
type('id=goods_expireAt','2015-03-18')
type('id=goods_faceValue','55')
type('id=goods_originalPrice','555')
type('id=goods_salePrice','55')
type('id=goods_baseSale','55')
type('id=levelPrices_NORMAL','1')
type('id=levelPrices_VIP1','2')
type('id=levelPrices_VIP2','3')
type('id=levelPrices_VIP3','4')

runScript('var element= window.document.getElementsByTagName("iframe")[1];')
runScript('idocument = element.contentDocument;')
runScript('element=idocument.getElementsByTagName("body")[0];')
runScript('element.innerHTML  = "this is a test thread";')
clickAndWait('id=save')
verifyTitle('添加商品')
verifyTextPresent('到期时间不能早于有效期开始时间!')
verifyTextPresent('无效的图片!')
verifyTextPresent('采购价不能超过原价!')
verifyTextPresent('优惠啦销售价不能低于采购价!')
verifyTextPresent('VIP1加价不能超过前一级别的VIP加价!')
verifyTextPresent('VIP2加价不能超过前一级别的VIP加价!')
verifyTextPresent('VIP3加价不能超过前一级别的VIP加价!')

#{/selenium}



