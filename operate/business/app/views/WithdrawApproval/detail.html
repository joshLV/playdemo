#{extends 'layout_operate/layout.html' /}
#{set title:'系统账户查看' /}
#{include '/share/nav.html' /}
#{set 'moreStyles'}
<style type="text/css">
    .control-label{
        font-weight: bold;
    }
    .control-value{
        line-height: 28px;
        margin-left: 160px;
    }
    .form-horizontal .control-group{
        margin-bottom: 4px;
    }
</style>
#{/set}

<div class="row-fluid">
    <legend>提现申请明细</legend>
    <div class="form-horizontal">
        <div class="control-group">
            <label class="control-label">申请时间</label>
            <label class="control-value">${bill?.appliedAt.format('yyyy-MM-dd HH:mm:ss')}</label>
        </div>
        <div class="control-group">
            <label class="control-label">账户类型</label>
            <label class="control-value"> &{'account.type.' + bill.account.accountType}</label>
        </div>
        <div class="control-group">
            <label class="control-label">申 请 者</label>
            <label class="control-value">${bill?.applier}</label>
        </div>
        <div class="control-group">
            <label class="control-label">申请金额</label>
            <label class="control-value">${bill?.amount.formatCurrency('CNY')}</label>
        </div>
        <div class="control-group">
            <label class="control-label">所在城市</label>
            <label class="control-value">${bill?.bankCity}</label>
        </div>
        <div class="control-group">
            <label class="control-label">开户银行</label>
            <label class="control-value">${bill?.bankName}</label>
        </div>
        <div class="control-group">
            <label class="control-label">分行名称</label>
            <label class="control-value">${bill?.subBankName}</label>
        </div>
        <div class="control-group">
            <label class="control-label">开户姓名</label>
            <label class="control-value">${bill?.userName}</label>
        </div>
        <div class="control-group">
            <label class="control-label">银行卡号</label>
            <label class="control-value">${bill?.cardNumber}</label>
        </div>
        <div class="control-group">
            <label class="control-label">申请状态</label>
            <label class="control-value">&{'withdraw.' + bill.status}</label>
        </div>
        <div class="control-group">
            <label class="control-label">手续费</label>
            <label class="control-value">${bill.fee?.formatCurrency('CNY')}</label>
        </div>
        <div class="form-actions">
            #{if bill.status == models.accounts.WithdrawBillStatus.APPLIED}
                <a data-toggle="modal" href="#agree-modal" class="btn btn-primary">通过</a>
                <a data-toggle="modal" href="#reject-modal" class="btn btn-danger">拒绝</a>
            #{/if}
            #{else}
                <a href="/withdraw" class="btn btn-primary">返回</a>
            #{/else}
        </div>
    </div>

</div>
<div id="agree-modal" class="modal hide">
    <div class="modal-header">
        <button class="close" data-dismiss="modal">×</button>
        <h3>同意提现申请</h3>
    </div>

    #{form @WithdrawApproval.approve(), class:'form-horizontal'}
        <div class="modal-body">
            <fieldset>
                <div class="control-group">
                    <label class="control-label" for="agree-fee">手续费</label>
                    <div class="controls">
                        <input type="text" class="input-xlarge" id="agree-fee" name="fee" value="0">元
                    </div>
                </div>
                <div class="control-group">
                    <label class="control-label" for="agree-comment">备注</label>
                    <div class="controls">
                        <textarea rows="3" class="input-xlarge" id="agree-comment" name="comment">无</textarea>
                    </div>
                </div>
            </fieldset>
        </div>
        <div class="modal-footer">
            <a href="#" class="btn" data-dismiss="modal">关闭</a>
            <input type="hidden" name="id" value="${bill.id}">
            <input type="hidden" name="action" value="agree">
            <button class="btn btn-primary" type="submit">通过</button>
        </div>
    #{/form}
</div>
<div id="reject-modal" class="modal hide">
    <div class="modal-header">
        <button class="close" data-dismiss="modal">×</button>
        <h3>拒绝提现申请</h3>
    </div>

    #{form @WithdrawApproval.approve(), class:'form-horizontal'}
    <div class="modal-body">
        <fieldset>
            <div class="control-group">
                <label class="control-label" for="reject-comment">拒绝理由</label>
                <div class="controls">
                    <textarea rows="3" class="input-xlarge" id="reject-comment" name="comment" >请输入拒绝理由</textarea>
                </div>
            </div>
        </fieldset>
    </div>
    <div class="modal-footer">
        <a href="#" class="btn" data-dismiss="modal">关闭</a>
        <input type="hidden" name="id" value="${bill.id}">
        <input type="hidden" name="action" value="reject">
        <button class="btn btn-danger" type="submit">拒绝</button>
    </div>
    #{/form}
</div>
