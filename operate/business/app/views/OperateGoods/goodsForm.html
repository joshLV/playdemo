#{set 'moreScripts'}
    #{get 'moreScripts'/}
<script src="@{'/public/javascripts/goods-form.js'}" type="text/javascript" charset="UTF-8"></script>
#{/set}
#{layout_operate.selectField name:'goods.supplierId', value:goods?.supplierId, error:'goods.supplierId'}
    #{list items:supplierList, as:'supplier' }
        #{option supplier.id}${supplier.fullName}#{/option}
    #{/list}
#{/layout_operate.selectField}
<div class="control-group">
    <label class="control-label"><span style="color: red; ">*</span>商品分类</label>

    <div class="controls">
    #{layout_operate.selectList name:'goods.topCategoryId', value:goods?.topCategoryId, list:categoryList/}
    #{layout_operate.selectList name:'goods.categories.id', value:categoryId, list:subCategoryList/}
        <span class="error">#{error 'goods.category'/}</span>
    </div>
</div>
#{layout_operate.selectField name:'goods.brand.id', value:goods?.brand?.id, error:'goods.brand'}
    #{list items:brandList, as:'brand' }
        #{option brand?.id}${brand?.name}#{/option}
    #{/list}
#{/layout_operate.selectField}
#{layout_operate.textField name:'goods.no', value:goods?.no/}
#{layout_operate.nameField name:'goods.name', value:goods?.name, required:true, length:40/}
#{layout_operate.dateScopeField name:'goods.effective', begin:'goods.effectiveAt',end:'goods.expireAt',
beginValue:goods?.effectiveAt?.format(), endValue:goods?.expireAt?.format(), required:true/}
#{layout_operate.textField name:'goods.faceValue', value:goods?.faceValue?:"", note:'元', required:true/}
#{layout_operate.textField name:'goods.originalPrice', value:goods?.originalPrice?:"",note:'元', required:true/}
#{layout_operate.textField name:'goods.salePrice', value:goods?.salePrice?:"", note:'元', required:true/}
#{set i:0/}
#{list items:models.resale.ResalerLevel.values(), as: 'level'}
<div class="control-group">
    <label for='levelPrices_${level}' class="control-label">
        <span style="color: red; ">*</span>&{'goods.levelPrice.'+models.resale.ResalerLevel.values()[i]}</label>

    <div class="controls">
        <input type="text" id='levelPrices_${level}' name="levelPrices" class="input-xlarge"
               value="${goods?.levelPrices?goods.levelPrices.price[i]:''}"/>元
        #{field 'goods.levelPrice.'+level}
            <span class="error">#{error field?.name/}</span>
        #{/field}
    </div>
</div>
    #{set i++/}
#{/list}

#{layout_operate.textField name:'goods.baseSale', value:goods?.baseSale, note:'件', required:true/}
#{if "add".equals(action)}
    #{layout_operate.fileField name:'imagePath', required:true/}
#{/if}
#{else}
    #{layout_operate.fileField name:'imagePath'/}
<div class="control-group">
    <label for='levelPrices_${level}' class="control-label"> </label>

    <div class="controls">(修改前)<br/><img src="${goods.imageLargePath}"/></div>
</div>
#{/else}
#{layout_operate.htmlField name:'goods.prompt', value:goods?.prompt, uploadImgUrl:'/goods/images'/}
#{layout_operate.htmlField name:'goods.details', value:goods?.details, uploadImgUrl:'/goods/images', required:true/}
#{layout_operate.radioField name:'goods.isAllShop', value:goods?.isAllShop, required:true/}
<div class="control-group">
    <label class="control-label"></label>

    <div class="controls" id="shop" style="display:none">
        <table class="table table-striped table-bordered table-condensed">
            <tbody>
            #{list items:shopList, as:'shop' }
            <tr>
                <td><input type="checkbox" id="shops" value="${shop?.id}" name="goods.shops.id"
                           #{if shopIds?.contains(java.lang.String.valueOf(shop?.id))}checked#{/if}/></td>
                <td>${shop.name}</td>
                <td>${shop.address}</td>
                <td>${shop.phone}</td>
            </tr>
            #{/list}
            </tbody>
        </table>
    </div>
</div>
<div class="form-actions">
    <input class="btn btn-primary" id="save" type="submit" value="保存"/>
    <input class="btn btn-primary" id="onsale" type="submit" value="保存并上架"/>
    <input class="btn btn-primary" id="preview" type="submit" value="预览"/>
#{if "edit".equals(action)}
    #{vx.cancelButton url:'/goods', class:'btn btn-primary'/}
#{/if}
    <input type="hidden" id="status" name="goods.status" value="${goods?.status?:'OFFSALE'}"/>
</div>
<script type="text/javascript">
    $("input[name='goods.isAllShop']:checked").val() == 'false' ? $("#shop").show() : $("#shop").hide();
</script>