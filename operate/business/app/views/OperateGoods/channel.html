#{extends 'layout_operate/layout.html' /}
#{set title:'渠道商品管理' /}
#{include '/share/nav.html' /}
#{get 'moreScripts'}
<script src="@{'/public/javascripts/My97DatePicker/WdatePicker.js'}" type="text/javascript" charset="UTF-8"></script>
#{/get}
<div class="body">
    <legend>${title}</legend>
    <form class="form-horizontal" name="frmlist" id="form" action="@{OperateGoods.createChannel()}" method="POST">
    #{include "OperateGoods/channelForm.html"/}
    </form>

    <form class="form-horizontal" name="deletefrm" id="deletefrm">
        <table class="table table-striped table-bordered table-condensed">
            <thead>
            <tr>
                <th width="75">分销商</th>
                <th width="300">商品名称</th>
                <th width="180">标签</th>
                <th width="200">URL</th>
                <th width="100">上架时间</th>
                <th width="100">下架时间</th>
                <th width="50">状态</th>
                <th width="100">创建人</th>
                <th width="80"> 操 作</th>
            </tr>
            </thead>

            <tbody>

            #{paginate.list items:channelGoodsInfoList, as:'channel'}
            <tr>
                <td align="center">${channel.resaler.loginName}</td>
                <td>${channel.goods.shortName?.raw()}</td>
                <td><a href="${channel.url}" target="_blank">${channel?.tag}</a></td>
                <td><a href="${channel.url}" target="_blank">${channel.url}</a></td>
                <td>${channel?.onSaleAt?.format('yyyy-MM-dd HH:mm:ss')}</td>
                <td>${channel?.offSaleAt?.format('yyyy-MM-dd HH:mm:ss')}</td>
                <td>&{'channel.'+channel?.status}</td>
                <td>${channel.operateName}</td>
                <td>
                    #{if channel.resaler?.salesId==operateUserId}
                        <a href="#" onclick="edit(${channel.id})"> 修改 </a>
                        / #{vx.deleteLink action:"channel-goods", id:channel.id/}
                    #{/if}
            </tr>
            #{/paginate.list}
            </tbody>
        </table>
    </form>
    <div class="pagination" align="center">
        <ul>
        #{paginate.controls items:channelGoodsInfoList /}
        </ul>
    </div>
</div>
<script type="text/javascript">
    function edit(id) {
        $("#form").load("/channel-goods/" + id + "/edit", function (data) {
            $("#form").attr("action", "/channel-goods/" + id + "?x-http-method-override=PUT");
            $("#form").attr("method", "POST");
        });
    }


</script>