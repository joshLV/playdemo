#{extends 'layout_operate/layout.html' /}
#{set title:'渠道商品管理' /}
#{include '/share/nav.html' /}
#{get 'moreScripts'}
<script src="@{'/public/javascripts/My97DatePicker/WdatePicker.js'}" type="text/javascript" charset="UTF-8"></script>
#{/get}
<div class="body">
    <legend>${title}</legend>
    <form class="form-horizontal" name="frmlist" id="form" action="@{OperateGoods.createChannel()}" method="POST">
           #{include "OperateGoods/channelForm.html"/}

        *{<input type="hidden" name="goodsId" value="${goods.id}">}*

        *{<div class="control-group">}*
            *{<label class="control-label"><span style="color: red; ">*</span>分销商</label>}*

            *{<div class="controls">}*
            *{#{select 'channelGoodsInfo.resaler.id', id:'condition_status', class:'input-small'}}*
                *{#{option ""}不限#{/option}}*
                *{#{list items:resalerList,as:'resaler'}}*
                    *{#{option resaler.id}${resaler.loginName}-${resaler.userName}#{/option}}*
                *{#{/list}}*
            *{#{/select}}*
            *{</div>}*
        *{</div>}*
    *{#{layout_operate.textField name:'channelGoodsInfo.goods.shortName', value:goods?.shortName,disabled:true/}}*
    *{#{layout_operate.textField name:'channelGoodsInfo.url', required:true/}}*
    *{#{layout_operate.dateTimeField name:'channelGoodsInfo.onSaleAt',value:goods?.beginOnSaleAt?.format('yyyy-MM-dd HH:mm:ss'),required:true/}}*
    *{#{layout_operate.dateTimeField name:'channelGoodsInfo.offSaleAt',value:goods?.endOnSaleAt?.format('yyyy-MM-dd HH:mm:ss'),required:true/}}*
        *{<div class="form-actions">}*
            *{<input class="btn btn-primary" id="save" type="submit" value="确定"/>}*
            *{<input class="btn btn-primary" type="submit" value="取消"/>}*
        *{</div>}*
    </form>

    <form class="form-horizontal" name="deletefrm" id="deletefrm">
        <table class="table table-striped table-bordered table-condensed">
            <thead>
            <tr>
                <th width="75">分销商</th>
                <th width="200">商品名称</th>
                <th width="100">URL</th>
                <th width="100">上架时间</th>
                <th width="100">下架时间</th>
                <th width="100">创建人</th>
                <th width="80"> 操 作</th>
            </tr>
            </thead>

            <tbody>

            #{paginate.list items:channelGoodsInfoList, as:'channel'}
            <tr>
                <td align="center">${channel.resaler.loginName}</td>
                <td>${channel.goods.shortName?.raw()}</td>
                <td>${channel.url}</td>
                <td>${channel.onSaleAt.format('yyyy-MM-dd HH:mm:ss')}</td>
                <td>${channel.offSaleAt.format('yyyy-MM-dd HH:mm:ss')}</td>
                <td>${channel.operateName}</td>
                <td><a href="#" onclick="edit(${channel.id})"> 修改 </a>
                    / #{vx.deleteLink action:"channel-goods", id:channel.id/}
            </tr>
            #{/paginate.list}
            </tbody>
        </table>
    </form>
    <div class="pagination" align="center">
        <ul>
        #{paginate.controls items:channelGoodsInfoList /}
        </ul>
    </div>
</div>
 <script type="text/javascript">
    function edit(id) {
        $("#form").load("/channel-goods/" + id + "/edit", function (data) {
            $("#form").attr("action", "/channel-goods/" + id + "?x-http-method-override=PUT");
            $("#form").attr("method", "POST");
        });
    }


</script>