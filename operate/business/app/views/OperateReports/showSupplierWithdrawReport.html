#{extends 'layout_operate/layout.html' /}
#{set title:'商户提现汇总' /}
#{include '/share/nav.html' /}

#{set 'moreScripts'}
*{<script src="@{'/public/javascripts/My97DatePicker/WdatePicker.js'}" type="text/javascript" charset="UTF-8"></script>}*
<script src="@{'/public/javascripts/DateRangePicker/date.js'}" type="text/javascript" charset="UTF-8"></script>
<script src="@{'/public/javascripts/DateRangePicker/daterangepicker.js'}" type="text/javascript"
        charset="UTF-8"></script>
#{/set}

<link rel="stylesheet" href="/public/stylesheets/daterangepicker.css"
      type="text/css" media="screen"/>

#{set 'moreStyles'}
<style type="text/css">
    .form-inline ul {
        display: inline-block;
        margin-bottom: -15px;
    }

    .nav-tabs {
        margin-bottom: 0px;
    }

    .tab-content {
        border-left: 1px solid #DDD;
        border-right: 1px solid #DDD;
        border-bottom: 1px solid #DDD;
        clear: both;
    }

    .tab-content .binary {
        width: 40%;
        float: left;
        text-align: center;
        margin: 5px 1%;
    }

    .seq {
        margin-top: 20px;
    }

    .alert {
        margin-bottom: 0px;
    }

    .seq thead tr :first {
        background-color: #f5f5f5;
    }

    footer {
        margin-top: 20px;
    }
</style>
#{/set}

<div class="body">
    <form class="well form-inline" action="@{OperateReports.showSupplierWithdrawReport()}" method="GET" id="form">
        商户
    #{vx.selectInputField name:"supplierName", id:"condition.accountUid", list:supplierList, value: condition?.accountUid/}

    *{起止日期}*
    *{<input type="text" id="condition_begin" class="input-medium Wdate" name="condition.createdAtBegin"}*
    *{onfocus="WdatePicker({readOnly:true})" value="${condition?.createdAtBegin?.format()}"> -}*
    *{<input type="text" id="condition_end" class="input-medium Wdate" name="condition.createdAtEnd"}*
    *{onfocus="WdatePicker({readOnly:true})" value="${condition?.createdAtEnd?.format()}">}*
        日期
        <div id="daterange" class="pull-right inline daterange "
             style="background: #fff; cursor: pointer; padding: 5px 10px; border: 1px solid #ccc">

            <i class="icon-calendar icon-large"></i>
                <span>
                </span> <b class="caret" style="margin-top: 8px"></b>
        </div>
        <input type="hidden" id="condition_begin" name="condition.createdAtBegin"
               value="${condition?.createdAtBegin?.format()}">
        <input type="hidden" id="condition_end" name="condition.createdAtEnd"
               value="${condition?.createdAtEnd?.format()}">

        <script type="text/javascript">
            $(document).ready(function () {
                $('.daterange').daterangepicker(
                        {
                            ranges:{
                                '今天':['today', 'today'],
                                '昨天':['yesterday', 'yesterday'],
                                '最近7天':[Date.today().add({ days:-6 }), 'today'],
                                '过去30天':[Date.today().add({ days:-29 }), 'today'],
                                '本月':[Date.today().moveToFirstDayOfMonth(), Date.today().moveToLastDayOfMonth()],
                                '上个月':[Date.today().moveToFirstDayOfMonth().add({ months:-1 }), Date.today().moveToFirstDayOfMonth().add({ days:-1 })]
                            },
                            opens:'left',
                            format:'MM/dd/yyyy',
                            separator:' to ',
                            startDate:Date.today().add({ days:-29 }),
                            endDate:Date.today(),
                            minDate:'01/01/2012',
                            maxDate:'12/31/2013',
                            locale:{
                                applyLabel:'提交',
                                fromLabel:'从',
                                toLabel:'到',
                                customRangeLabel:'自定义',
                                daysOfWeek:['日', '一', '二', '三', '四', '五', '六'],
                                monthNames:['一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一', '十二'],
                                firstDay:1
                            },
                            showWeekNumbers:true,
                            buttonClasses:['btn-danger'],
                            dateLimit:false
                        },
                        function (start, end) {
                            $('.daterange span').html(start.toString('MMMM d, yyyy') + ' - ' + end.toString('MMMM d, yyyy'));
                            $("#condition_begin").val(start.toString('MMMM d, yyyy') );
                            $("#condition_end").val(end.toString('MMMM d, yyyy'));

                        }
                );

                //Set the initial state of the picker label
                $('.daterange span').html(Date.today().add({ days:-29 }).toString('MMMM d, yyyy') + ' - ' + Date.today().toString('MMMM d, yyyy'));

            });
        </script>


        <button type="submit" class="btn btn-primary">搜索</button>

    </form>

    <table class="table table-striped table-bordered table-condensed">
        <tr>
            <th>序号</th>
            <th>商户名称</th>
            <th style="text-align: right;">期初未提现金额</th>
            <th style="text-align: right;">本周期券消费金额</th>
            <th style="text-align: right;">本周期提现金额</th>
            <th style="text-align: right;">剩余未提现金额</th>
        </tr>
    #{set i:1/}
    #{paginate.list items:supplierWithdrawReportPage, as:'supplierWithdraw'}
        <tr>
            <td>${i}</td>
            <td>${supplierWithdraw?.supplier?.otherName} </td>
            <td style="text-align: right;">${supplierWithdraw?.previousUnwithdrawnAmount}</td>
            <td style="text-align: right;">${supplierWithdraw?.consumedAmount}</td>
            <td style="text-align: right;">
            ${supplierWithdraw?.withdrawnAmount}
            </td>
            <td style="text-align: right;">
            ${supplierWithdraw?.remainedUnwithdrawnAmount}
            </td>
        </tr>
        #{set i++/}
    #{/paginate.list}
    </table>

    <div class="pagination">
        <ul>
        #{paginate.controls items:supplierWithdrawReportPage /}
        </ul>
    </div>

</div>


