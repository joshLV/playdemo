#{fixture delete:[models.admin.OperateUser.class,
      models.admin.OperateRole.class],
  load:['fixture/roles.yml','fixture/supplier_users.yml'] /}

#{selenium}
   #{include 'test/selenium/step/login.selenium' /}
   open('/users')
   assertTitle('操作员一览')
#{/selenium}

#{selenium}
   #{include 'test/selenium/step/login.selenium' /}
   open('/users/${play.test.Fixtures.idCache.get("models.admin.OperateUser-user1")}/edit')
   assertTitle('操作员编辑')
#{/selenium}


#{selenium}
   #{include 'test/selenium/step/login.selenium' /}
   open('/users/${play.test.Fixtures.idCache.get("models.admin.OperateUser-user3")}/edit')
   click('xpath=(//input[@id='operateUser.roles.id'])[2]')
   verifyTextPresent('tom')
   type('id=mobile','13012012011')
   type('name=operateUser.encryptedPassword','')
   clickAndWait('id=save')
   verifyTextPresent('请输入密码!')
#{/selenium}

#{selenium "edit user"}
   #{include 'test/selenium/step/login.selenium' /}
   open('/users/${play.test.Fixtures.idCache.get("models.admin.OperateUser-test")}/edit')
   click('xpath=(//input[@id='operateUser.roles.id'])[2]')
   verifyTextPresent('test')
   type('id=userName','uuuuu')
   type('id=mobile','13088192012')
   type('id=email','11@qq.com')
   type('id=jobNumber','113242')
   type('name=operateUser.encryptedPassword','123456')
   clickAndWait('id=save')
   assertNotTitle('操作员编辑')

   open('/users')
   assertTitle('操作员一览')
   verifyTextPresent('test')
#{/selenium}

#{selenium "delete user"}
  #{include 'test/selenium/step/login.selenium' /}
  open('/users')
  assertTitle('操作员一览')
  verifyTextPresent('test_delete_user')
  clickAndWait('id=del_${play.test.Fixtures.idCache.get("models.admin.OperateUser-deleteuser")}')
  assertConfirmation('确定删除吗？')

  verifyTextPresent('操作员一览')
  verifyTextNotPresent('test_delete_user')
#{/selenium}


 #{selenium "edit 个人信息"}
   #{include 'test/selenium/step/login.selenium' /}
   open('/profile')
   assertTitle('个人信息')
   verifyTextPresent('tom')
   assertValue('id=mobile','13211111111')
   type('id=mobile','13211111121')
   type('id=userName','yyy')
   clickAndWait('id=save')
   assertValue('id=mobile','13211111121')
   assertValue('id=userName','yyy')

#{/selenium}
