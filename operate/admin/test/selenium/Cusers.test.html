#{fixture delete:[models.admin.SupplierUser.class,
      models.admin.SupplierRole.class],
  load:['fixture/roles.yml','fixture/cusers.yml'] /}

#{selenium}
   #{include 'test/selenium/step/login.selenium' /}
   open('/users')
   assertTitle('操作员一览')
#{/selenium}

#{selenium}
   #{include 'test/selenium/step/login.selenium' /}
   open('/users/${play.test.Fixtures.idCache.get("models.admin.SupplierUser-user1")}/edit')
   assertTitle('操作员编辑')
#{/selenium}


#{selenium}
   #{include 'test/selenium/step/login.selenium' /}
   open('/users/${play.test.Fixtures.idCache.get("models.admin.SupplierUser-user3")}/edit')
   click('xpath=(//input[@id='cuser.roles.id'])[2]')
   type('id=loginName','yan1')
   type('id=mobile','13012012011')
   type('name=cuser.encryptedPassword','')
   clickAndWait('id=save')
   verifyTextPresent('请输入密码!')
#{/selenium}

#{selenium "edit user"}
   #{include 'test/selenium/step/login.selenium' /}
   open('/users/${play.test.Fixtures.idCache.get("models.admin.SupplierUser-test")}/edit')
   click('xpath=(//input[@id='cuser.roles.id'])[2]')
   type('id=loginName','test')
   type('id=mobile','13088092012')
   type('name=cuser.encryptedPassword','123')
   clickAndWait('id=save')
   assertNotTitle('操作员编辑')

   open('/users')
   assertTitle('操作员一览')
   verifyTextPresent('test')
#{/selenium}

#{selenium "delete user"}
  #{include 'test/selenium/step/login.selenium' /}
  open('/users')
  assertTitle('操作员一览')
  verifyTextPresent('test_delete_user')
  clickAndWait('id=del_${play.test.Fixtures.idCache.get("models.admin.SupplierUser-deleteuser")}')
  assertConfirmation('确定删除吗？')

  verifyTextPresent('操作员一览')
  verifyTextNotPresent('test_delete_user')
#{/selenium}


