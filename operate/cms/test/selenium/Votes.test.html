#{fixture delete:[models.admin.OperateUser.class,models.admin.OperateRole.class,
models.cms.VoteQuestion.class],
load:['fixture/roles.yml','fixture/users.yml','fixture/votes.yml'] /}

#{selenium '信息调查一览'}
    #{include 'test/selenium/step/login.selenium' /}
open('/votes')
verifyTitle('调查信息一览')
assertTextPresent('优惠啦网站改版了，改成什么名字？')
assertTextPresent('2012-06-13')
assertTextPresent('2012-06-13')
assertTextPresent('有奖问答')
#{/selenium}

#{selenium '修改信息调查'}
    #{include 'test/selenium/step/login.selenium' /}
open('/votes/${play.test.Fixtures.idCache.get("models.cms.VoteQuestion-vote1")}/edit')
verifyTitle('修改调查信息')
verifyValue('id=vote_content','asfa')
verifyValue('id=vote_answer1','4213')
verifyValue('id=vote_answer2','1241')
verifyValue('id=vote_answer3','asfa')
type('id=vote_effectiveAt','2012-06-13')
type('id=vote_expireAt','2012-06-11')
clickAndWait('id=save')
verifyTextPresent('到期时间不能早于有效期开始时间!')

type('id=vote_content','asfa——test')
type('id=vote_answer1','A.4213')
type('id=vote_answer2','B.1241')
type('id=vote_answer3','C.asfa')
type('id=vote_answer4','D.ghg')
clickAndWait('id=save')
assertTextPresent('asfa——test')
#{/selenium}

#{selenium '删除信息调查'}
    #{include 'test/selenium/step/login.selenium' /}
open('/votes')
verifyTitle('调查信息一览')
click('id=del_${play.test.Fixtures.idCache.get("models.cms.VoteQuestion-vote1")}')
assertConfirmation('您确定要删除吗？')
verifyTitle('调查信息一览')

#{/selenium}

#{selenium '添加信息调查'}
    #{include 'test/selenium/step/login.selenium' /}
open('/votes/new')
type('id=vote_effectiveAt','2012-06-13')
type('id=vote_expireAt','2012-06-13')
type('id=vote_content','new')
type('id=vote_answer1','A.qqq')
type('id=vote_answer2','B.aaaa')
type('id=vote_answer3','C.rrrr')
type('id=vote_answer4','D.tttt')
type('id=vote_correctAnswer','C')
clickAndWait('id=save')
verifyTitle('调查信息一览')
assertTextPresent('优惠啦网站改版了，改成什么名字？')
assertTextPresent('new')
assertTextNotPresent('asfa')
#{/selenium}